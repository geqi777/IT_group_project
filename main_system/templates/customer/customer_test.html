{% extends 'customer_layout.html' %}

{% block content %}
  <h2>预定车辆</h2>

  <form method="POST">
    {% csrf_token %}
    <label for="start_time">选择预定开始时间:</label>
    <input type="datetime-local" id="start_time" name="start_time" required>

    <label for="end_time">选择预定结束时间:</label>
    <input type="datetime-local" id="end_time" name="end_time" required>

    <label for="location">选择租车地点:</label>
    <select id="location" name="location" required>
        {% for loc in locations %}
            <option value="{{ loc.id }}">{{ loc.name }}</option>
        {% endfor %}
    </select>

    <label for="vehicle_type">选择车辆类型:</label>
    <select id="vehicle_type" name="vehicle_type" required>
        <option value="electric_car">Electric Car</option>
        <option value="scooter">Scooter</option>
    </select>

    <button type="submit">搜索车辆</button>
  </form>

  {% if selected_vehicle_type == 'electric_car' and available_vehicles %}
    <h3>选择可用的电动车:</h3>
    <form method="POST">
      {% csrf_token %}
      <input type="hidden" name="start_time" value="{{ start_time }}">
      <input type="hidden" name="end_time" value="{{ end_time }}">
      <input type="hidden" name="location" value="{{ location.id }}">
      <input type="hidden" name="vehicle_type" value="{{ selected_vehicle_type }}">
      
      <select name="vehicle_id" required>
        {% for vehicle in available_vehicles %}
          <option value="{{ vehicle.id }}">{{ vehicle.name }} - 电量: {{ vehicle.power }}%</option>
        {% endfor %}
      </select>

      <button type="submit">预定电动车</button>
    </form>
  {% endif %}
{% endblock %}
